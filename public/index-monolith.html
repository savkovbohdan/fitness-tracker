<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí™ –§–∏—Ç–Ω–µ—Å-–¢—Ä–µ–∫–µ—Ä</title>
    <link rel="stylesheet" href="styles/ultra-modern.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
    <div id="app"></div>

    <script>
        const { createApp, ref, onMounted } = Vue;

        // ExerciseIcon Component
        const ExerciseIcon = {
            props: {
                photoUrl: String,
                size: {
                    type: Number,
                    default: 48
                }
            },
            computed: {
                iconClass() {
                    return this.photoUrl ? 'exercise-icon photo' : 'exercise-icon placeholder';
                },
                iconStyle() {
                    return {
                        width: this.size + 'px',
                        height: this.size + 'px'
                    };
                }
            },
            template: `
                <div :class="iconClass" :style="iconStyle">
                    <img v-if="photoUrl" :src="photoUrl" alt="Exercise" 
                         style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px;" />
                    <span v-else>üí™</span>
                </div>
            `
        };

        // MainScreen Component
        const MainScreen = {
            emits: ['change-screen'],
            props: {
                error: String,
                success: String
            },
            template: `
                <div class="container">
                    <div class="header">
                        <h1>üí™ –§–∏—Ç–Ω–µ—Å-–¢—Ä–µ–∫–µ—Ä</h1>
                        <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–π —Å–≤–æ–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
                    </div>
                    
                    <div v-if="error" class="error">{{ error }}</div>
                    <div v-if="success" class="success">{{ success }}</div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">12</div>
                            <div class="stat-label">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">248</div>
                            <div class="stat-label">–ü–æ–¥—Ö–æ–¥–æ–≤</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">1.8K</div>
                            <div class="stat-label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–π</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">8</div>
                            <div class="stat-label">–î–Ω–µ–π</div>
                        </div>
                    </div>
                    
                    <div class="nav-tabs">
                        <button class="nav-tab active" @click="$emit('change-screen', 'exercises')">
                            üí™ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
                        </button>
                        <button class="nav-tab" @click="$emit('change-screen', 'history')">
                            üìä –ò—Å—Ç–æ—Ä–∏—è
                        </button>
                        <button class="nav-tab" @click="$emit('change-screen', 'stats')">
                            üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                        </button>
                    </div>
                    
                    <div class="card">
                        <h3 style="margin-bottom: 20px; color: #1a202c; font-size: 20px; font-weight: 700;">
                            –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
                        </h3>
                        <button class="button pulse" @click="$emit('change-screen', 'exercises')">
                            üöÄ –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                        </button>
                        <button class="button secondary" @click="$emit('change-screen', 'exercises')">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
                        </button>
                    </div>
                </div>
            `
        };

        // ExercisesScreen Component
        const ExercisesScreen = {
            components: { ExerciseIcon },
            emits: ['change-screen', 'select-exercise', 'show-error', 'show-success', 'refresh-exercises'],
            props: {
                exercises: Array,
                loading: Boolean
            },
            data() {
                return {
                    showAddForm: false,
                    newExercise: { name: '', category: '–≥—Ä—É–¥—å', photo_url: '' },
                    addingExercise: false,
                    uploadingPhoto: false
                };
            },
            methods: {
                async uploadPhoto(file) {
                    if (!file) return;
                    
                    this.uploadingPhoto = true;
                    const formData = new FormData();
                    formData.append('photo', file);

                    try {
                        const response = await axios.post('/api/upload-exercise-photo', formData, {
                            headers: { 'Content-Type': 'multipart/form-data' }
                        });
                        this.newExercise.photo_url = response.data.photo_url;
                        this.$emit('show-success', '–§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!');
                    } catch (err) {
                        this.$emit('show-error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ: ' + (err.response?.data?.error || err.message));
                    } finally {
                        this.uploadingPhoto = false;
                    }
                },
                async addExercise() {
                    if (!this.newExercise.name.trim()) {
                        this.$emit('show-error', '–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ');
                        return;
                    }

                    this.addingExercise = true;
                    try {
                        await axios.post('/api/exercises', this.newExercise);
                        this.$emit('show-success', '–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ "' + this.newExercise.name + '" –¥–æ–±–∞–≤–ª–µ–Ω–æ!');
                        this.$emit('refresh-exercises');
                        
                        setTimeout(() => {
                            this.showAddForm = false;
                            this.newExercise = { name: '', category: '–≥—Ä—É–¥—å', photo_url: '' };
                        }, 2000);
                    } catch (err) {
                        this.$emit('show-error', err.response?.data?.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è');
                    } finally {
                        this.addingExercise = false;
                    }
                },
                selectExercise(exercise) {
                    this.$emit('select-exercise', exercise);
                }
            },
            template: `
                <div class="container">
                    <div class="header">
                        <h1>üí™ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h1>
                        <p>–í—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
                    </div>
                    
                    <div class="nav-tabs">
                        <button class="nav-tab active" @click="$emit('change-screen', 'exercises')">
                            üí™ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
                        </button>
                        <button class="nav-tab" @click="$emit('change-screen', 'history')">
                            üìä –ò—Å—Ç–æ—Ä–∏—è
                        </button>
                        <button class="nav-tab" @click="$emit('change-screen', 'stats')">
                            üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                        </button>
                    </div>
                    
                    <button class="button glow" @click="showAddForm = true" style="margin-bottom: 24px;">
                        ‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
                    </button>
                    
                    <div v-if="showAddForm" class="form-section">
                        <h3 style="margin-bottom: 20px; color: white; font-size: 20px; font-weight: 700;">
                            –ù–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
                        </h3>
                        <div class="form-group">
                            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</label>
                            <input v-model="newExercise.name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ñ–∏–º –ª–µ–∂–∞" />
                        </div>
                        <div class="form-group">
                            <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                            <select v-model="newExercise.category">
                                <option value="–≥—Ä—É–¥—å">üí™ –ì—Ä—É–¥—å</option>
                                <option value="–Ω–æ–≥–∏">ü¶µ –ù–æ–≥–∏</option>
                                <option value="—Å–ø–∏–Ω–∞">üîô –°–ø–∏–Ω–∞</option>
                                <option value="–ø–ª–µ—á–∏">ü§∏ –ü–ª–µ—á–∏</option>
                                <option value="—Ä—É–∫–∏">üí™ –†—É–∫–∏</option>
                                <option value="–ø—Ä–µ—Å—Å">üéØ –ü—Ä–µ—Å—Å</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">–§–æ—Ç–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</label>
                            <input type="file" @change="uploadPhoto($event.target.files[0])" 
                                   accept="image/*" style="display: none;" ref="fileInput" />
                            <button class="button secondary" @click="$refs.fileInput.click()" 
                                    :disabled="uploadingPhoto" style="width: 100%;">
                                {{ uploadingPhoto ? 'üì∏ –ó–∞–≥—Ä—É–∑–∫–∞...' : 'üì∑ –í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ç–æ' }}
                            </button>
                        </div>
                        
                        <div v-if="newExercise.photo_url" style="margin-bottom: 20px; text-align: center;">
                            <img :src="newExercise.photo_url" alt="Preview"
                                 style="width: 120px; height: 120px; object-fit: cover; 
                                        border-radius: 16px; border: 3px solid #4299e1; box-shadow: 0 8px 20px rgba(0,0,0,0.2);" />
                            <div style="font-size: 14px; color: white; margin-top: 8px; font-weight: 600;">
                                ‚úÖ –§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 12px;">
                            <button class="button" @click="addExercise" 
                                    :disabled="addingExercise || uploadingPhoto">
                                {{ addingExercise ? '‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ...' : '‚úÖ –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ' }}
                            </button>
                            <button class="button secondary" @click="showAddForm = false">
                                ‚ùå –û—Ç–º–µ–Ω–∞
                            </button>
                        </div>
                    </div>
                    
                    <div v-if="loading" class="loading">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π...</div>
                    <div v-else class="card">
                        <h3 style="margin-bottom: 24px; color: #1a202c; font-size: 20px; font-weight: 700;">
                            –î–æ—Å—Ç—É–ø–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è ({{ exercises.length }})
                        </h3>
                        <div v-for="exercise in exercises" :key="exercise.id" class="exercise-item">
                            <div class="exercise-content">
                                <div class="exercise-photo">
                                    <img v-if="exercise.photo_url" :src="exercise.photo_url" :alt="exercise.name"
                                         @error="$event.target.style.display = 'none'" />
                                    <div v-else style="width: 100%; height: 100%; display: flex; 
                                               align-items: center; justify-content: center; 
                                               background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%); 
                                               border-radius: 16px; font-size: 36px; color: white;">
                                        üí™
                                    </div>
                                </div>
                                <div class="exercise-info">
                                    <div class="exercise-name">{{ exercise.name }}</div>
                                    <span class="category">{{ exercise.category }}</span>
                                </div>
                            </div>
                            <button class="button secondary" @click="selectExercise(exercise)">
                                –í—ã–±—Ä–∞—Ç—å ‚Üí
                            </button>
                        </div>
                    </div>
                    
                    <button class="button secondary" @click="$emit('change-screen', 'main')" style="margin-top: 20px;">
                        ‚Üê –ù–∞–∑–∞–¥
                    </button>
                </div>
            `
        };

        // WorkoutScreen Component
        const WorkoutScreen = {
            components: { ExerciseIcon },
            emits: ['change-screen', 'show-success', 'show-error'],
            props: {
                selectedExercise: Object
            },
            data() {
                return {
                    savedSets: [],
                    weight: '',
                    reps: '',
                    useBodyweight: false
                };
            },
            methods: {
                async addSet() {
                    if (!this.reps.trim()) {
                        this.$emit('show-error', '–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π');
                        return;
                    }

                    if (!this.useBodyweight && !this.weight.trim()) {
                        this.$emit('show-error', '–í–≤–µ–¥–∏—Ç–µ –≤–µ—Å –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å"');
                        return;
                    }

                    try {
                        const response = await axios.post('/api/workout-sets', {
                            exercise_id: this.selectedExercise.id,
                            reps: parseInt(this.reps),
                            weight: this.useBodyweight ? '–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å' : parseFloat(this.weight)
                        });

                        this.savedSets.push(response.data);
                        this.$emit('show-success', '–ü–æ–¥—Ö–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω!');
                        this.reps = '';
                        this.weight = '';
                        
                        setTimeout(() => this.$emit('show-success', ''), 2000);
                    } catch (err) {
                        this.$emit('show-error', err.response?.data?.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ–¥—Ö–æ–¥–∞');
                    }
                },
                finishWorkout() {
                    this.$emit('show-success', '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ø–æ–¥—Ö–æ–¥–æ–≤: ' + this.savedSets.length);
                    setTimeout(() => {
                        this.$emit('change-screen', 'main');
                    }, 2000);
                }
            },
            template: `
                <div class="container">
                    <div class="header">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <ExerciseIcon :photoUrl="selectedExercise.photo_url" :size="60" 
                                         style="border: 2px solid #e5e7eb;" />
                            <div>
                                <h1 style="margin: 0;">üí™ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</h1>
                                <p style="margin: 4px 0 0 0; font-size: 18px; font-weight: bold;">
                                    {{ selectedExercise.name }}
                                </p>
                                <span class="category">{{ selectedExercise.category }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div v-if="savedSets.length > 0" class="card">
                        <h3>–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã ({{ savedSets.length }}):</h3>
                        <div v-for="set in savedSets" :key="set.id" 
                             style="padding: 8px 0; border-bottom: 1px solid #e5e7eb;">
                            <strong>–ü–æ–¥—Ö–æ–¥ {{ set.set_number }}:</strong> 
                            {{ set.reps }} –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π, {{ set.weight }} 
                            {{ set.weight === '–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å' ? '' : '–∫–≥' }}
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥:</h3>
                        <div style="margin: 16px 0;">
                            <div style="margin: 12px 0;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" v-model="useBodyweight" style="margin-right: 8px;" />
                                    –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ—Å
                                </label>
                            </div>
                            
                            <input v-if="!useBodyweight" type="number" placeholder="–í–µ—Å (–∫–≥)" 
                                   v-model="weight" style="margin-bottom: 12px;" />
                            <input type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π" v-model="reps" />
                        </div>
                        
                        <div style="display: flex; gap: 8px;">
                            <button class="button" @click="addSet" style="flex: 1;">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥
                            </button>
                            <button class="button danger" @click="finishWorkout" style="flex: 1;">
                                ‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                            </button>
                        </div>
                    </div>
                </div>
            `
        };

        // HistoryScreen Component
        const HistoryScreen = {
            components: { ExerciseIcon },
            emits: ['change-screen'],
            data() {
                return {
                    workoutHistory: [],
                    loading: false
                };
            },
            methods: {
                async loadWorkoutHistory() {
                    this.loading = true;
                    try {
                        const response = await axios.get('/api/workout-logs/1');
                        this.workoutHistory = response.data;
                    } catch (err) {
                        console.error('Error loading workout history:', err);
                        this.workoutHistory = [];
                    } finally {
                        this.loading = false;
                    }
                }
            },
            mounted() {
                this.loadWorkoutHistory();
            },
            template: `
                <div class="container">
                    <div class="header">
                        <h1>üìä –ò—Å—Ç–æ—Ä–∏—è</h1>
                        <p>–¢–≤–æ–∏ –ø—Ä–æ—à–ª—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</p>
                    </div>
                    
                    <div v-if="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏...</div>
                    <div v-else-if="workoutHistory.length === 0" class="card">
                        <div class="loading">–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –ø—É—Å—Ç–∞</div>
                    </div>
                    <div v-else>
                        <div v-for="day in workoutHistory" :key="day.date" class="workout-day">
                            <div class="workout-day-header">
                                <h3 class="workout-day-title">
                                    {{ new Date(day.date).toLocaleDateString('ru-RU', { 
                                        day: 'numeric', month: 'long', year: 'numeric' 
                                    }) }}
                                </h3>
                                <div class="workout-day-stats">
                                    {{ day.totalSets }} –ø–æ–¥—Ö–æ–¥–æ–≤, {{ day.totalReps }} –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
                                </div>
                            </div>
                            <div v-for="exercise in day.exercises" :key="exercise.name" class="exercise-in-history">
                                <div style="display: flex; align-items: center; margin-bottom: 12px;">
                                    <ExerciseIcon :photoUrl="exercise.photo_url" :size="40" />
                                    <div style="flex: 1; min-width: 0;">
                                        <div style="font-weight: bold; font-size: 16px; margin-bottom: 4px;">
                                            {{ exercise.name }}
                                        </div>
                                        <div style="font-size: 12px; color: #718096;">
                                            <span class="category">{{ exercise.category }}</span>
                                        </div>
                                    </div>
                                    <div style="text-align: right; margin-left: 12px; flex-shrink: 0;">
                                        <div style="font-size: 14px; font-weight: bold; color: #667eea;">
                                            {{ exercise.maxWeight }}
                                        </div>
                                        <div style="font-size: 12px; color: #718096;">
                                            {{ exercise.totalSets }}√ó{{ exercise.totalReps }}
                                        </div>
                                    </div>
                                </div>
                                <div style="font-size: 12px; color: #718096; margin-bottom: 4px; padding-left: 56px;">
                                    –ü–æ–¥—Ö–æ–¥—ã: {{ exercise.setsDetail }}
                                </div>
                                <div style="font-size: 11px; color: #a0aec0; padding-left: 56px;">
                                    –ü–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ–¥—Ö–æ–¥: {{ new Date(exercise.lastSetTime).toLocaleTimeString('ru-RU', {
                                        hour: '2-digit', minute: '2-digit'
                                    }) }}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="button" @click="$emit('change-screen', 'main')">‚Üê –ù–∞–∑–∞–¥</button>
                </div>
            `
        };

        // StatsScreen Component
        const StatsScreen = {
            emits: ['change-screen'],
            template: `
                <div class="container">
                    <div class="header">
                        <h1>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h1>
                        <p>–¢–≤–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</p>
                    </div>
                    
                    <div class="card">
                        <h3>üèãÔ∏è‚Äç‚ôÇÔ∏è –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                        <div style="padding: 16px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                                <span>–í—Å–µ–≥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫:</span>
                                <strong>12</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                                <span>–í—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–æ–≤:</span>
                                <strong>248</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                                <span>–í—Å–µ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π:</span>
                                <strong>1,856</strong>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>–ê–∫—Ç–∏–≤–Ω—ã—Ö –¥–Ω–µ–π:</span>
                                <strong>8</strong>
                            </div>
                        </div>
                    </div>
                    
                    <button class="button" @click="$emit('change-screen', 'main')">‚Üê –ù–∞–∑–∞–¥</button>
                </div>
            `
        };

        // Main App
        const App = {
            components: {
                MainScreen,
                ExercisesScreen,
                WorkoutScreen,
                HistoryScreen,
                StatsScreen
            },
            data() {
                return {
                    currentScreen: 'main',
                    exercises: [],
                    selectedExercise: null,
                    loading: false,
                    error: null,
                    success: null
                };
            },
            methods: {
                async loadExercises() {
                    this.loading = true;
                    try {
                        const response = await axios.get('/api/exercises');
                        this.exercises = response.data;
                    } catch (err) {
                        this.error = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π';
                        console.error('Error loading exercises:', err);
                    } finally {
                        this.loading = false;
                    }
                },
                changeScreen(screen) {
                    this.currentScreen = screen;
                    this.error = null;
                    this.success = null;
                },
                selectExercise(exercise) {
                    this.selectedExercise = exercise;
                    this.currentScreen = 'workout';
                },
                showError(message) {
                    this.error = message;
                    setTimeout(() => this.error = null, 3000);
                },
                showSuccess(message) {
                    this.success = message;
                    setTimeout(() => this.success = null, 2000);
                }
            },
            mounted() {
                this.loadExercises();
            },
            template: `
                <div class="fade-in">
                    <MainScreen v-if="currentScreen === 'main'" 
                               @change-screen="changeScreen"
                               :error="error" :success="success" />
                    
                    <ExercisesScreen v-else-if="currentScreen === 'exercises'"
                                   @change-screen="changeScreen"
                                   @select-exercise="selectExercise"
                                   @show-error="showError"
                                   @show-success="showSuccess"
                                   @refresh-exercises="loadExercises"
                                   :exercises="exercises" :loading="loading" />
                    
                    <WorkoutScreen v-else-if="currentScreen === 'workout' && selectedExercise"
                                  @change-screen="changeScreen"
                                  @show-error="showError"
                                  @show-success="showSuccess"
                                  :selected-exercise="selectedExercise" />
                    
                    <HistoryScreen v-else-if="currentScreen === 'history'"
                                  @change-screen="changeScreen" />
                    
                    <StatsScreen v-else-if="currentScreen === 'stats'"
                                @change-screen="changeScreen" />
                </div>
            `
        };

        createApp(App).mount('#app');
    </script>
</body>
</html>
