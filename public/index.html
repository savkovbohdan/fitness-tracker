<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí™ –§–∏—Ç–Ω–µ—Å-–¢—Ä–µ–∫–µ—Ä</title>
    <link rel="stylesheet" href="styles/ultra-modern.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
    <div id="app"></div>

    <script type="module">
        import MainScreen from './components/MainScreen.vue';
        import ExercisesScreen from './components/ExercisesScreen.vue';
        import WorkoutScreen from './components/WorkoutScreen.vue';
        import HistoryScreen from './components/HistoryScreen.vue';
        import StatsScreen from './components/StatsScreen.vue';

        const { createApp, ref, onMounted } = Vue;

        // Main App
        const App = {
            components: {
                MainScreen,
                ExercisesScreen,
                WorkoutScreen,
                HistoryScreen,
                StatsScreen
            },
            data() {
                return {
                    currentScreen: 'main',
                    exercises: [],
                    selectedExercise: null,
                    loading: false,
                    error: null,
                    success: null
                };
            },
            methods: {
                async loadExercises() {
                    this.loading = true;
                    try {
                        const response = await axios.get('/api/exercises');
                        this.exercises = response.data;
                    } catch (err) {
                        this.error = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π';
                        console.error('Error loading exercises:', err);
                    } finally {
                        this.loading = false;
                    }
                },
                changeScreen(screen) {
                    this.currentScreen = screen;
                    this.error = null;
                    this.success = null;
                },
                selectExercise(exercise) {
                    this.selectedExercise = exercise;
                    this.currentScreen = 'workout';
                },
                showError(message) {
                    this.error = message;
                    setTimeout(() => this.error = null, 3000);
                },
                showSuccess(message) {
                    this.success = message;
                    setTimeout(() => this.success = null, 2000);
                }
            },
            mounted() {
                this.loadExercises();
            },
            template: `
                <div class="fade-in">
                    <MainScreen v-if="currentScreen === 'main'" 
                               @change-screen="changeScreen"
                               :error="error" :success="success" />
                    
                    <ExercisesScreen v-else-if="currentScreen === 'exercises'"
                                   @change-screen="changeScreen"
                                   @select-exercise="selectExercise"
                                   @show-error="showError"
                                   @show-success="showSuccess"
                                   @refresh-exercises="loadExercises"
                                   :exercises="exercises" :loading="loading" />
                    
                    <WorkoutScreen v-else-if="currentScreen === 'workout' && selectedExercise"
                                  @change-screen="changeScreen"
                                  @show-error="showError"
                                  @show-success="showSuccess"
                                  :selected-exercise="selectedExercise" />
                    
                    <HistoryScreen v-else-if="currentScreen === 'history'"
                                  @change-screen="changeScreen" />
                    
                    <StatsScreen v-else-if="currentScreen === 'stats'"
                                @change-screen="changeScreen" />
                </div>
            `
        };

        createApp(App).mount('#app');
    </script>
</body>
</html>
